<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="`RefCell`s and code smells"><title>show_notes::e016 - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-9ee3a5e31a2afa3e.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="show_notes" data-themes="" data-resource-suffix="" data-rustdoc-version="1.75.0-nightly (aa1a71e9e 2023-10-26)" data-channel="nightly" data-search-js="search-8fbf244ebcf71464.js" data-settings-js="settings-74424d7eec62a23e.js" ><script src="../../static.files/storage-fec3eaa3851e447d.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-5f34af1a0ee6bacd.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-5d8b3c7633ad77ba.css"></noscript><link rel="icon" href="https://newrustacean.com/favicon.ico"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../show_notes/index.html"><img src="https://newrustacean.com/podcast.png" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../show_notes/index.html"><img src="https://newrustacean.com/podcast.png" alt="logo"></a><h2><a href="../../show_notes/index.html">show_notes</a><span class="version">0.3.1</span></h2></div><h2 class="location"><a href="#">Module e016</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#functions">Functions</a></li></ul></section><h2><a href="../index.html">In crate show_notes</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">show_notes</a>::<wbr><a class="mod" href="#">e016</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="src" href="../../src/show_notes/e016.rs.html#1-251">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p><code>RefCell</code>s and code smells</p>
<ul>
<li><strong>Date:</strong> July 23, 2016</li>
<li><strong>Subject:</strong> Digging deeper on smart pointers and mutability with
<code>Cell</code> and <code>RefCell</code>.</li>
<li><a href="https://www.podtrac.com/pts/redirect.mp3/cdn.newrustacean.com/file/newrustacean/e016.mp3"><strong>Audio</strong></a></li>
</ul>
<p><audio style="width: 100%" title="Borrow a Cell or Clone a Cow" controls preload=metadata><source src="https://www.podtrac.com/pts/redirect.mp3/cdn.newrustacean.com/file/newrustacean/e016.mp3"></audio></p>
<h3 id="notes"><a href="#notes">Notes</a></h3>
<p>What are the <code>Cell</code> and <code>RefCell</code> types, and when should we use them?</p>
<p>Today, we follow up both the detailed discussion of smart pointers in
<a href="https://www.newrustacean.com/show_notes/e015/">e015</a> and the closely related discussion in <a href="https://www.newrustacean.com/show_notes/interview/_2/">Interview 2</a> with Raph Levien,
and look at two types you need to have a good idea how to deal with if you
want to use these smart pointer types more <em>ergonomically</em>—that is, how to
use them without feeling like you’re beating your head against a wall!</p>
<p>The descriptions of the code below are minimal; see the inline comments in
<a href="/src/show_notes/e016.rs.html">the source</a> for the actual informative discussion.</p>
<h4 id="a-comment-on-the-code-samples"><a href="#a-comment-on-the-code-samples">A comment on the code samples</a></h4>
<p>Note that in several cases below we use <code>&amp;[]</code> to borrow a reference to a
slice, rather than requiring this to pass a reference to a <code>Vec</code>
specifically. Making the first argument be of type
<code>&amp;Vec&lt;RefCell&lt;SimpleNonCopyable&gt;&gt;</code> would also work, but would be more
restrictive in what it could and couldn’t accept. Since <code>Vec</code> implements
<a href="https://doc.rust-lang.org/1.10.0/std/ops/trait.Deref.html"><code>Deref</code></a> to automatically convert to slices, this works just fine, <em>and</em> is
more general. This is how you should usually write function signatures which
operate on reference to vectors (and likewise for other types which can
dereference to slices). We’ll talk about this more in a future episode!</p>
<h3 id="links"><a href="#links">Links</a></h3>
<ul>
<li>Rust 1.10
<ul>
<li><a href="https://blog.rust-lang.org/2016/07/07/Rust-1.10.html">blog post</a></li>
<li><a href="https://github.com/rust-lang/rust/blob/master/RELEASES.md#version-1100-2016-07-07">full release notes</a></li>
<li>cdylib
<ul>
<li>RFC: <a href="https://github.com/rust-lang/rfcs/blob/master/text/1510-rdylib.md">text</a> | <a href="https://github.com/rust-lang/rfcs/pull/1510">discussion</a></li>
<li><a href="https://github.com/rust-lang/rust/pull/33553">implementation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://internals.rust-lang.org/t/beta-testing-rustup-rs/3316/144">rustup 0.3.0 release</a></li>
<li><a href="http://www.integer32.com">Integer32</a> (Carol Nichols’ and Jake Goulding’s new Rust consultancy)
<ul>
<li><a href="http://www.integer32.com/2016/07/11/why-rust.html">announcement blog post</a></li>
<li><a href="https://www.reddit.com/r/rust/comments/4sdncw/why_were_starting_a_rust_consultancy/">reddit discussion</a></li>
</ul>
</li>
<li><a href="https://intellij-rust.github.io">IntelliJ Rust</a>
<ul>
<li><a href="https://www.reddit.com/r/rust/comments/4sbqaq/intellijrust_has_a_website_now/">reddit discussion</a></li>
</ul>
</li>
<li>Tango: <a href="https://github.com/pnkfelix/tango">source</a> | <a href="https://skillsmatter.com/skillscasts/8372-tango-literate-programming-in-rust">talk</a></li>
<li><code>Cell</code> and <code>RefCell</code>:
<ul>
<li><a href="https://doc.rust-lang.org/book/choosing-your-guarantees.html#cell-types">Cell Types</a> in <em>The Rust Programming Language</em></li>
<li>Standard library:
<ul>
<li><a href="https://doc.rust-lang.org/std/cell/index.html"><code>std::cell</code></a> module docs (detailed explanation, complementary to the book)</li>
<li><a href="https://doc.rust-lang.org/std/cell/struct.Cell.html"><code>Cell&lt;T&gt;</code></a> docs (at <code>std::cell::Cell</code>)</li>
<li><a href="https://doc.rust-lang.org/std/cell/struct.RefCell.html"><code>RefCell&lt;T&gt;</code></a> docs (at <code>stc::cell::RefCell</code>)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="sponsors"><a href="#sponsors">Sponsors</a></h3>
<ul>
<li>Aleksey Pirogov</li>
<li><a href="http://red-oxide.org/">Chris Palmer</a></li>
<li><a href="twitter.com/daniel_collin">Daniel Collin</a></li>
<li><a href="https://twitter.com/derekmorr">Derek Morr</a></li>
<li>Doug Reeves</li>
<li>Eric Fulmer</li>
<li>Hamza Sheikh</li>
<li><a href="https://github.com/Limeth">Jakub “Limeth” Hlusička</a></li>
<li>Keith Gray</li>
<li>Lachlan Collins</li>
<li>Leif Arne Storset</li>
<li>Luca Schmid</li>
<li>Micael Bergeron</li>
<li>Michael Clayton</li>
<li><a href="https://pascalhertleif.de/">Pascal Hertleif</a></li>
<li>Ralph Giles (“rillian”)</li>
<li>Ralph “FriarTech” Loizzo</li>
<li>Raph Levien</li>
<li>reddraggone9</li>
<li>Ryan Ollos</li>
<li>Vesa Kaihlavirta</li>
<li><a href="http://willroe.me">William Roe</a></li>
</ul>
<p>(Thanks to the couple people donating who opted out of the reward tier, as
well. You know who you are!)</p>
<h4 id="become-a-sponsor"><a href="#become-a-sponsor">Become a sponsor</a></h4>
<ul>
<li><a href="https://www.patreon.com/newrustacean" rel="payment">Patreon</a></li>
<li><a href="https://venmo.com/chriskrycho">Venmo</a></li>
<li><a href="https://www.dwolla.com/hub/chriskrycho">Dwolla</a></li>
<li><a href="https://cash.me/$chriskrycho">Cash.me</a></li>
<li><a href="https://flattr.com/profile/chriskrycho">Flattr</a></li>
<li><a href="https://paypal.me/chriskrycho">PayPal.me</a></li>
</ul>
<h3 id="contact"><a href="#contact">Contact</a></h3>
<ul>
<li>New Rustacean:
<ul>
<li>Twitter: <a href="https://www.twitter.com/newrustacean">@newrustacean</a></li>
<li>Email: <a href="mailto:hello@newrustacean.com">hello@newrustacean.com</a></li>
</ul>
</li>
<li>Chris Krycho
<ul>
<li>GitHub: <a href="https://github.com/chriskrycho">chriskrycho</a></li>
<li>Twitter: <a href="https://www.twitter.com/chriskrycho">@chriskrycho</a></li>
</ul>
</li>
</ul>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.SimpleContainer.html" title="struct show_notes::e016::SimpleContainer">SimpleContainer</a></div><div class="desc docblock-short">A container showing a type where <code>Cell&lt;T&gt;</code> works with <code>Vec&lt;T&gt;</code>.</div></li><li><div class="item-name"><a class="struct" href="struct.SimpleNonCopyable.html" title="struct show_notes::e016::SimpleNonCopyable">SimpleNonCopyable</a></div><div class="desc docblock-short">A container showing where <code>Cell&lt;T&gt;</code> doesn’t work and <code>RefCell&lt;T&gt;</code> does.</div></li></ul><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.add_to_each_string.html" title="fn show_notes::e016::add_to_each_string">add_to_each_string</a></div><div class="desc docblock-short">Demonstrate interior mutability with <code>Rc</code> and <code>RefCell</code>.</div></li><li><div class="item-name"><a class="fn" href="fn.demonstrate_need_for_cell.html" title="fn show_notes::e016::demonstrate_need_for_cell">demonstrate_need_for_cell</a></div><div class="desc docblock-short">Demonstrate how you need <code>Cell&lt;T&gt;</code> even just with a <code>Vec&lt;T&gt;</code>;</div></li><li><div class="item-name"><a class="fn" href="fn.double_cell.html" title="fn show_notes::e016::double_cell">double_cell</a></div><div class="desc docblock-short">Operate mutably on the contenets of an immutable reference to a <code>Vec</code>.</div></li></ul></section></div></main><link rel="stylesheet" href="/media-playback.css">
<script type="text/javascript" src="/media-playback.js" defer></script>


</body></html>